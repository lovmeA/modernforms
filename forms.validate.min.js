!function($,window,document,undefined){var _form=function(t,e){this.form=t,this.defaults={},this.options=$.extend({},this.defaults,e),this.methods={GET:"GET",POST:"POST",HEAD:"HEAD",PUT:"PUT",DELETE:"DELETE",CONNECT:"CONNECT",OPTIONS:"OPTIONS",TRACE:"TRACE"}};_form.prototype={init:function(){var t=this,e=t.options.submitBtn;return t.for_form(),t.initParams(),t.data={required:t.func.required,min:t.func.minOrMax,max:t.func.minOrMax,length:t.func.lengths,rules:t.func.rules,equal:t.func.equal,phone:t.func.mobile,email:t.func.email,idcard:t.func.IdCard,url:t.func.url},(e!==undefined?$(e):this.form.find("input:submit")).on("click",function(){t.clickValidation()}),this},for_form:function(){var a=this;$.each(a.form[0],function(t,r){""!==$(r)[0].name&&($(r).on("input propertychange",function(){var n=!0;$.each($(r)[0].dataset,function(t,e){"ruleMessage"!==t&&(a.data[t]($(r))||(a.errFunc[t]($(r),a),n=a.data[t]($(r))),n&&a.msg.success($(r)))})}),$(r).on("blur",function(){var n=!0;$.each($(r)[0].dataset,function(t,e){"ruleMessage"!==t&&(a.data[t]($(r))||(a.errFunc[t]($(r),a),n=a.data[t]($(r))),n&&a.msg.success($(r)))})}))})},initParams:function(){var t=this,e=t.options.sends===undefined||t.options.sends,n=t.methods[(t.options.method?t.options.method:"POST").trim().toUpperCase()];t.url=t.options.url?t.options.url:t.form[0].action,t.method=n!==undefined?n:"POST",t.async=!0!==t.options.async&&!1!==t.options.async||t.options.async,t.sends=!0!==e&&!1!==e||e}},_form.prototype.errFunc={required:function(t,e){e.msg.error(t,t.attr("data-required"))},min:function(t,e){e.msg.error(t,"最小值为:"+t.attr("data-min"))},max:function(t,e){e.msg.error(t,"最大值为:"+t.attr("data-max"))},length:function(t,e){var n=t.attr("data-length").split("-");if(1===n.length&&e.msg.error(t,"最多最少输入"+n[0]+"个字符"),2===n.length)if("*"===n[n.length-1])e.msg.error(t,"最少输入"+n[0]+"个字符");else{var r=t.attr("data-length");e.msg.error(t,"输入字符长度["+r+"]个字符")}},rules:function(t,e){e.msg.error(t,t.attr("data-rule-message"))},equal:function(t,e){e.msg.error(t,"当前输入不一致！")},phone:function(t,e){e.msg.error(t,t.attr("data-phone"))},email:function(t,e){e.msg.error(t,t.attr("data-email"))},idcard:function(t,e){e.msg.error(t,t.attr("data-idcard"))},url:function(t,e){e.msg.error(t,t.attr("data-url"))}},_form.prototype.clickValidation=function(){var r=this,a=!0;$.each(r.form[0],function(t,n){""!==$(n)[0].name&&$.each($(n)[0].dataset,function(t,e){"ruleMessage"!==t&&(r.data[t]($(n),r)||(r.errFunc[t]($(n),r),a=r.data[t]($(n))))})}),a&&r.sends&&r.sendData()},_form.prototype.func={required:function(t){var e=t.val();return""!==e&&null!=e},minOrMax:function(t){var e=t.val(),n=parseInt(t.attr("data-min")),r=parseInt(t.attr("data-max"));if(e=parseInt(e)){if(isNaN(e)||e<n)return!1;if(!isNaN(e)&&r<e)return!1}return!0},lengths:function(t){var e=t.val(),n=t.attr("data-length").split("-");if(""!==e&&1===n.length){var r=parseInt(n);if(e.length!==r)return!1}else if(""!==e&&2===n.length)if("*"===n[1]){var a=parseInt(n[0]);if(e.length<a)return!1}else{var o=parseInt(n[0]),s=parseInt(n[1]);if(e.length<o||e.length>s)return!1}return!0},rules:function(objects){var value=objects.val(),rule=objects.attr("data-rules");return rule=new RegExp(eval(rule)),!(""!==value&&!rule.test(value))},equal:function(t){return t.val()===$(t.attr("data-equal")).val()},mobile:function(t){var e=t.val();return!(""!==e&&!/^(13[0-9]|14[579]|15[0-3,5-9]|16[6]|17[0135678]|18[0-9]|19[89])\d{8}$/.test(e)&&!/^(0\d{2,3}\d{7,8}|0\d{2,3}-)\d{7,8}$/.test(e))},email:function(t){var e=t.val();return!(""!==e&&!/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/.test(e))},IdCard:function(t){var e=t.val();return!(""!==e&&!/^([1-9]\d{5}[1]\d{3}(0[1-9]|1[0-2])(0[1-9]|[1-2]\d|3[0-1])\d{3}[0-9xX]|[1-9]\d{5}\d{2}(0[1-9]|1[0-2])(0[1-9]|[1-2]\d|3[0-1])\d{3})$/.test(e))},url:function(t){var e=t.val();return!(""!==e&&!/^https?:\/\/[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^<>\"\"])*$/.test(e))}},_form.prototype.getCookie=function(){var t=null;if(document.cookie&&""!==document.cookie)for(var e=document.cookie.split(";"),n=0;n<e.length;n++){var r=e[n].trim().split("=");"csrftoken"===r[0]&&(t=r[1]);break}return t},_form.prototype.sendData=function(){var t=this,n=new FormData(t.form[0]);t.options.data!==undefined&&$.each(t.options.data,function(t,e){n.append(t,e)});var e=new XMLHttpRequest;e.open(t.method,t.url,t.async),e.setRequestHeader("X-CSRFToken",t.getCookie()),e.setRequestHeader("x-requested-with","XMLHttpRequest"),e.onreadystatechange=function(){4===e.readyState&&(200===e.status?t.options.success&&t.options.success($.parseJSON(e.responseText)):t.options.fail&&t.options.fail($.parseJSON(e.responseText)))},e.send(n)},_form.prototype.msg={error:function(t,e){t.siblings(".mdn-msg").remove(),t.parent().addClass("mdn-error"),t.parent().append('<span class="mdn-msg msg-hidden right">'+e+"</span>")},success:function(t){t.parent().removeClass("mdn-error"),t.siblings(".mdn-msg").remove()}},$.fn.form=function(t){return new _form(this,t).init()}}(jQuery,window,document);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZGVybmZvcm1zL2Zvcm1zLnZhbGlkYXRlLmpzIl0sIm5hbWVzIjpbIiQiLCJ3aW5kb3ciLCJkb2N1bWVudCIsInVuZGVmaW5lZCIsIl9mb3JtIiwiZWxlIiwib3B0IiwidGhpcyIsImZvcm0iLCJkZWZhdWx0cyIsIm9wdGlvbnMiLCJleHRlbmQiLCJtZXRob2RzIiwiR0VUIiwiUE9TVCIsIkhFQUQiLCJQVVQiLCJERUxFVEUiLCJDT05ORUNUIiwiT1BUSU9OUyIsIlRSQUNFIiwicHJvdG90eXBlIiwiaW5pdCIsIm1lIiwic0J0biIsInN1Ym1pdEJ0biIsImZvcl9mb3JtIiwiaW5pdFBhcmFtcyIsImRhdGEiLCJyZXF1aXJlZCIsImZ1bmMiLCJtaW4iLCJtaW5Pck1heCIsIm1heCIsImxlbmd0aCIsImxlbmd0aHMiLCJydWxlcyIsImVxdWFsIiwicGhvbmUiLCJtb2JpbGUiLCJlbWFpbCIsImlkY2FyZCIsIklkQ2FyZCIsInVybCIsImZpbmQiLCJvbiIsImNsaWNrVmFsaWRhdGlvbiIsImVhY2giLCJpIiwidiIsIm5hbWUiLCJpc19zdWNjZXNzIiwiZGF0YXNldCIsImlpIiwidnYiLCJlcnJGdW5jIiwibXNnIiwic3VjY2VzcyIsInNlbmQiLCJzZW5kcyIsIm1ldGhvZCIsInRyaW0iLCJ0b1VwcGVyQ2FzZSIsImFjdGlvbiIsImFzeW5jIiwidGFyZ2V0IiwiZXJyb3IiLCJhdHRyIiwic3BsaXQiLCJjaGFuZ2R1Iiwic2VuZERhdGEiLCJvYmplY3RzIiwidmFsdWUiLCJ2YWwiLCJwYXJzZUludCIsImlzTmFOIiwic3RhcnRfZW5kIiwibnVtIiwibWluX2xlbmd0aCIsInJ1bGUiLCJSZWdFeHAiLCJldmFsIiwidGVzdCIsImdldENvb2tpZSIsImNvb2tpZVZhbHVlIiwiY29va2llIiwiY29va2llcyIsIkZvcm1EYXRhIiwiayIsImFwcGVuZCIsInhociIsIlhNTEh0dHBSZXF1ZXN0Iiwib3BlbiIsInNldFJlcXVlc3RIZWFkZXIiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwic3RhdHVzIiwicGFyc2VKU09OIiwicmVzcG9uc2VUZXh0IiwiZmFpbCIsImVycm9yTWVzc2FnZSIsInNpYmxpbmdzIiwicmVtb3ZlIiwicGFyZW50IiwiYWRkQ2xhc3MiLCJyZW1vdmVDbGFzcyIsImZuIiwialF1ZXJ5Il0sIm1hcHBpbmdzIjoiQ0FBQyxTQUFXQSxFQUFHQyxPQUFRQyxTQUFVQyxXQUM3QixJQUFJQyxNQUFRLFNBQVVDLEVBQUtDLEdBQ3ZCQyxLQUFLQyxLQUFPSCxFQUNaRSxLQUFLRSxTQUFXLEdBQ2hCRixLQUFLRyxRQUFVVixFQUFFVyxPQUFPLEdBQUlKLEtBQUtFLFNBQVVILEdBQzNDQyxLQUFLSyxRQUFVLENBQ1hDLElBQUssTUFDTEMsS0FBTSxPQUNOQyxLQUFNLE9BQ05DLElBQUssTUFDTEMsT0FBUSxTQUNSQyxRQUFTLFVBQ1RDLFFBQVMsVUFDVEMsTUFBTyxVQUlmaEIsTUFBTWlCLFVBQVksQ0FDZEMsS0FBTSxXQUNGLElBQUlDLEVBQUtoQixLQUNMaUIsRUFBT0QsRUFBR2IsUUFBUWUsVUFxQnRCLE9BbkJBRixFQUFHRyxXQUNISCxFQUFHSSxhQUVISixFQUFHSyxLQUFPLENBQ05DLFNBQVVOLEVBQUdPLEtBQUtELFNBQ2xCRSxJQUFLUixFQUFHTyxLQUFLRSxTQUNiQyxJQUFLVixFQUFHTyxLQUFLRSxTQUNiRSxPQUFRWCxFQUFHTyxLQUFLSyxRQUNoQkMsTUFBT2IsRUFBR08sS0FBS00sTUFDZkMsTUFBT2QsRUFBR08sS0FBS08sTUFDZkMsTUFBT2YsRUFBR08sS0FBS1MsT0FDZkMsTUFBT2pCLEVBQUdPLEtBQUtVLE1BQ2ZDLE9BQVFsQixFQUFHTyxLQUFLWSxPQUNoQkMsSUFBS3BCLEVBQUdPLEtBQUthLE1BR2hCbkIsSUFBU3JCLFVBQVlILEVBQUV3QixHQUFRakIsS0FBS0MsS0FBS29DLEtBQUssaUJBQWlCQyxHQUFHLFFBQVMsV0FDeEV0QixFQUFHdUIsb0JBRUF2QyxNQUdYbUIsU0FBVSxXQUNOLElBQUlILEVBQUtoQixL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S0FBSzlCLElBR2J4QixNQUFNaUIsVUFBVW1DLElBQU0sQ0FDbEJVLE1BQU8sU0FBVUQsRUFBUW1DLEdBQ3JCbkMsRUFBT29DLFNBQVMsWUFBWUMsU0FFNUJyQyxFQUFPc0MsU0FBU0MsU0FBUyxhQUN6QnZDLEVBQU9zQyxTQUFTZCxPQUFPLDBDQUE0Q1csRUFBZSxZQUd0RjNDLFFBQVMsU0FBVVEsR0FDZkEsRUFBT3NDLFNBQVNFLFlBQVksYUFDNUJ4QyxFQUFPb0MsU0FBUyxZQUFZQyxXQUlwQ3RHLEVBQUUwRyxHQUFHbEcsS0FBTyxTQUFVRSxHQUdsQixPQUZpQixJQUFJTixNQUFNRyxLQUFNRyxHQUVmWSxRQWxWekIsQ0FvVkVxRixPQUFRMUcsT0FBUUMiLCJmaWxlIjoibW9kZXJuZm9ybXMvZm9ybXMudmFsaWRhdGUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiOyhmdW5jdGlvbiAoJCwgd2luZG93LCBkb2N1bWVudCwgdW5kZWZpbmVkKSB7XG4gICAgdmFyIF9mb3JtID0gZnVuY3Rpb24gKGVsZSwgb3B0KSB7XG4gICAgICAgIHRoaXMuZm9ybSA9IGVsZTtcbiAgICAgICAgdGhpcy5kZWZhdWx0cyA9IHt9O1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgdGhpcy5kZWZhdWx0cywgb3B0KTtcbiAgICAgICAgdGhpcy5tZXRob2RzID0ge1xuICAgICAgICAgICAgR0VUOiAnR0VUJyxcbiAgICAgICAgICAgIFBPU1Q6ICdQT1NUJyxcbiAgICAgICAgICAgIEhFQUQ6ICdIRUFEJyxcbiAgICAgICAgICAgIFBVVDogJ1BVVCcsXG4gICAgICAgICAgICBERUxFVEU6ICdERUxFVEUnLFxuICAgICAgICAgICAgQ09OTkVDVDogJ0NPTk5FQ1QnLFxuICAgICAgICAgICAgT1BUSU9OUzogJ09QVElPTlMnLFxuICAgICAgICAgICAgVFJBQ0U6ICdUUkFDRSdcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgX2Zvcm0ucHJvdG90eXBlID0ge1xuICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgbWUgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIHNCdG4gPSBtZS5vcHRpb25zLnN1Ym1pdEJ0bjtcblxuICAgICAgICAgICAgbWUuZm9yX2Zvcm0oKTtcbiAgICAgICAgICAgIG1lLmluaXRQYXJhbXMoKTtcblxuICAgICAgICAgICAgbWUuZGF0YSA9IHtcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogbWUuZnVuYy5yZXF1aXJlZCxcbiAgICAgICAgICAgICAgICBtaW46IG1lLmZ1bmMubWluT3JNYXgsXG4gICAgICAgICAgICAgICAgbWF4OiBtZS5mdW5jLm1pbk9yTWF4LFxuICAgICAgICAgICAgICAgIGxlbmd0aDogbWUuZnVuYy5sZW5ndGhzLFxuICAgICAgICAgICAgICAgIHJ1bGVzOiBtZS5mdW5jLnJ1bGVzLFxuICAgICAgICAgICAgICAgIGVxdWFsOiBtZS5mdW5jLmVxdWFsLFxuICAgICAgICAgICAgICAgIHBob25lOiBtZS5mdW5jLm1vYmlsZSxcbiAgICAgICAgICAgICAgICBlbWFpbDogbWUuZnVuYy5lbWFpbCxcbiAgICAgICAgICAgICAgICBpZGNhcmQ6IG1lLmZ1bmMuSWRDYXJkLFxuICAgICAgICAgICAgICAgIHVybDogbWUuZnVuYy51cmxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIChzQnRuICE9PSB1bmRlZmluZWQgPyAkKHNCdG4pIDogdGhpcy5mb3JtLmZpbmQoXCJpbnB1dDpzdWJtaXRcIikpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBtZS5jbGlja1ZhbGlkYXRpb24oKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZm9yX2Zvcm06IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBtZSA9IHRoaXM7XG5cbiAgICAgICAgICAgICQuZWFjaChtZS5mb3JtWzBdLCBmdW5jdGlvbiAoaSwgdikge1xuICAgICAgICAgICAgICAgIGlmICgkKHYpWzBdLm5hbWUgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgICAgICQodikub24oJ2lucHV0IHByb3BlcnR5Y2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzX3N1Y2Nlc3MgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKCQodilbMF0uZGF0YXNldCwgZnVuY3Rpb24gKGlpLCB2dikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpaSAhPT0gJ3J1bGVNZXNzYWdlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1lLmRhdGFbaWldKCQodikpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZS5lcnJGdW5jW2lpXSgkKHYpLCBtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc19zdWNjZXNzID0gbWUuZGF0YVtpaV0oJCh2KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzX3N1Y2Nlc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lLm1zZy5zdWNjZXNzKCQodikpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICQodikub24oJ2JsdXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNfc3VjY2VzcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2goJCh2KVswXS5kYXRhc2V0LCBmdW5jdGlvbiAoaWksIHZ2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlpICE9PSAncnVsZU1lc3NhZ2UnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbWUuZGF0YVtpaV0oJCh2KSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lLmVyckZ1bmNbaWldKCQodiksIG1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzX3N1Y2Nlc3MgPSBtZS5kYXRhW2lpXSgkKHYpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNfc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUubXNnLnN1Y2Nlc3MoJCh2KSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9LFxuXG4gICAgICAgIGluaXRQYXJhbXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBtZSA9IHRoaXMsXG4gICAgICAgICAgICAgICAgc2VuZCA9IChtZS5vcHRpb25zLnNlbmRzICE9PSB1bmRlZmluZWQpID8gbWUub3B0aW9ucy5zZW5kcyA6IHRydWUsXG4gICAgICAgICAgICAgICAgbWV0aG9kID0gbWUubWV0aG9kc1sobWUub3B0aW9ucy5tZXRob2QgPyBtZS5vcHRpb25zLm1ldGhvZCA6ICdQT1NUJykudHJpbSgpLnRvVXBwZXJDYXNlKCldO1xuICAgICAgICAgICAgbWUudXJsID0gbWUub3B0aW9ucy51cmwgPyBtZS5vcHRpb25zLnVybCA6IG1lLmZvcm1bMF0uYWN0aW9uO1xuICAgICAgICAgICAgbWUubWV0aG9kID0gKG1ldGhvZCAhPT0gdW5kZWZpbmVkKSA/IG1ldGhvZCA6ICdQT1NUJztcbiAgICAgICAgICAgIG1lLmFzeW5jID0gKG1lLm9wdGlvbnMuYXN5bmMgPT09IHRydWUgfHwgbWUub3B0aW9ucy5hc3luYyA9PT0gZmFsc2UpID8gbWUub3B0aW9ucy5hc3luYyA6IHRydWU7XG4gICAgICAgICAgICBtZS5zZW5kcyA9IChzZW5kID09PSB0cnVlIHx8IHNlbmQgPT09IGZhbHNlKSA/IHNlbmQgOiB0cnVlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIF9mb3JtLnByb3RvdHlwZS5lcnJGdW5jID0ge1xuICAgICAgICByZXF1aXJlZDogZnVuY3Rpb24gKHRhcmdldCwgbWUpIHtcbiAgICAgICAgICAgIG1lLm1zZy5lcnJvcih0YXJnZXQsIHRhcmdldC5hdHRyKCdkYXRhLXJlcXVpcmVkJykpXG4gICAgICAgIH0sXG4gICAgICAgIG1pbjogZnVuY3Rpb24gKHRhcmdldCwgbWUpIHtcbiAgICAgICAgICAgIG1lLm1zZy5lcnJvcih0YXJnZXQsICfmnIDlsI/lgLzkuLo6JyArIHRhcmdldC5hdHRyKCdkYXRhLW1pbicpKVxuICAgICAgICB9LFxuICAgICAgICBtYXg6IGZ1bmN0aW9uICh0YXJnZXQsIG1lKSB7XG4gICAgICAgICAgICBtZS5tc2cuZXJyb3IodGFyZ2V0LCAn5pyA5aSn5YC85Li6OicgKyB0YXJnZXQuYXR0cignZGF0YS1tYXgnKSlcbiAgICAgICAgfSxcbiAgICAgICAgbGVuZ3RoOiBmdW5jdGlvbiAodGFyZ2V0LCBtZSkge1xuICAgICAgICAgICAgdmFyIGRhdGEgPSB0YXJnZXQuYXR0cignZGF0YS1sZW5ndGgnKS5zcGxpdCgnLScpO1xuICAgICAgICAgICAgaWYgKGRhdGEubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgbWUubXNnLmVycm9yKHRhcmdldCwgXCLmnIDlpJrmnIDlsJHovpPlhaVcIiArIGRhdGFbMF0gKyBcIuS4quWtl+esplwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkYXRhLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgICAgICAgIGlmIChkYXRhW2RhdGEubGVuZ3RoIC0gMV0gPT09ICcqJykge1xuICAgICAgICAgICAgICAgICAgICBtZS5tc2cuZXJyb3IodGFyZ2V0LCBcIuacgOWwkei+k+WFpVwiICsgZGF0YVswXSArIFwi5Liq5a2X56ymXCIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGFuZ2R1ID0gdGFyZ2V0LmF0dHIoJ2RhdGEtbGVuZ3RoJyk7XG4gICAgICAgICAgICAgICAgICAgIG1lLm1zZy5lcnJvcih0YXJnZXQsIFwi6L6T5YWl5a2X56ym6ZW/5bqmW1wiICsgY2hhbmdkdSArIFwiXeS4quWtl+esplwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJ1bGVzOiBmdW5jdGlvbiAodGFyZ2V0LCBtZSkge1xuICAgICAgICAgICAgbWUubXNnLmVycm9yKHRhcmdldCwgdGFyZ2V0LmF0dHIoJ2RhdGEtcnVsZS1tZXNzYWdlJykpXG4gICAgICAgIH0sXG4gICAgICAgIGVxdWFsOiBmdW5jdGlvbiAodGFyZ2V0LCBtZSkge1xuICAgICAgICAgICAgbWUubXNnLmVycm9yKHRhcmdldCwgJ+W9k+WJjei+k+WFpeS4jeS4gOiHtO+8gScpXG4gICAgICAgIH0sXG4gICAgICAgIHBob25lOiBmdW5jdGlvbiAodGFyZ2V0LCBtZSkge1xuICAgICAgICAgICAgbWUubXNnLmVycm9yKHRhcmdldCwgdGFyZ2V0LmF0dHIoJ2RhdGEtcGhvbmUnKSlcbiAgICAgICAgfSxcbiAgICAgICAgZW1haWw6IGZ1bmN0aW9uICh0YXJnZXQsIG1lKSB7XG4gICAgICAgICAgICBtZS5tc2cuZXJyb3IodGFyZ2V0LCB0YXJnZXQuYXR0cignZGF0YS1lbWFpbCcpKVxuICAgICAgICB9LFxuICAgICAgICBpZGNhcmQ6IGZ1bmN0aW9uICh0YXJnZXQsIG1lKSB7XG4gICAgICAgICAgICBtZS5tc2cuZXJyb3IodGFyZ2V0LCB0YXJnZXQuYXR0cignZGF0YS1pZGNhcmQnKSlcbiAgICAgICAgfSxcbiAgICAgICAgdXJsOiBmdW5jdGlvbiAodGFyZ2V0LCBtZSkge1xuICAgICAgICAgICAgbWUubXNnLmVycm9yKHRhcmdldCwgdGFyZ2V0LmF0dHIoJ2RhdGEtdXJsJykpXG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgX2Zvcm0ucHJvdG90eXBlLmNsaWNrVmFsaWRhdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG1lID0gdGhpcztcbiAgICAgICAgdmFyIGlzX3N1Y2Nlc3MgPSB0cnVlO1xuICAgICAgICAkLmVhY2gobWUuZm9ybVswXSwgZnVuY3Rpb24gKGksIHYpIHtcbiAgICAgICAgICAgIGlmICgkKHYpWzBdLm5hbWUgIT09ICcnKSB7XG4gICAgICAgICAgICAgICAgJC5lYWNoKCQodilbMF0uZGF0YXNldCwgZnVuY3Rpb24gKGlpLCB2dikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWkgIT09ICdydWxlTWVzc2FnZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbWUuZGF0YVtpaV0oJCh2KSwgbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUuZXJyRnVuY1tpaV0oJCh2KSwgbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzX3N1Y2Nlc3MgPSBtZS5kYXRhW2lpXSgkKHYpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChpc19zdWNjZXNzICYmIG1lLnNlbmRzKSB7XG4gICAgICAgICAgICBtZS5zZW5kRGF0YSgpXG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgX2Zvcm0ucHJvdG90eXBlLmZ1bmMgPSB7XG4gICAgICAgIHJlcXVpcmVkOiBmdW5jdGlvbiAob2JqZWN0cykge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gb2JqZWN0cy52YWwoKTtcblxuICAgICAgICAgICAgaWYgKHZhbHVlID09PSAnJykge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfSxcblxuICAgICAgICBtaW5Pck1heDogZnVuY3Rpb24gKG9iamVjdHMpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IG9iamVjdHMudmFsKCksXG4gICAgICAgICAgICAgICAgbWluID0gcGFyc2VJbnQob2JqZWN0cy5hdHRyKFwiZGF0YS1taW5cIikpLFxuICAgICAgICAgICAgICAgIG1heCA9IHBhcnNlSW50KG9iamVjdHMuYXR0cihcImRhdGEtbWF4XCIpKTtcbiAgICAgICAgICAgIHZhbHVlID0gcGFyc2VJbnQodmFsdWUpO1xuXG4gICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4odmFsdWUpIHx8IG1pbiA+IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFpc05hTih2YWx1ZSkgJiYgbWF4IDwgdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuXG4gICAgICAgIGxlbmd0aHM6IGZ1bmN0aW9uIChvYmplY3RzKSB7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBvYmplY3RzLnZhbCgpLFxuICAgICAgICAgICAgICAgIHN0YXJ0X2VuZCA9IG9iamVjdHMuYXR0cignZGF0YS1sZW5ndGgnKS5zcGxpdCgnLScpO1xuXG4gICAgICAgICAgICBpZiAodmFsdWUgIT09ICcnICYmIHN0YXJ0X2VuZC5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICB2YXIgbnVtID0gcGFyc2VJbnQoc3RhcnRfZW5kKTtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUubGVuZ3RoICE9PSBudW0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodmFsdWUgIT09ICcnICYmIHN0YXJ0X2VuZC5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgICAgICBpZiAoc3RhcnRfZW5kWzFdID09PSAnKicpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1pbl9sZW5ndGggPSBwYXJzZUludChzdGFydF9lbmRbMF0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUubGVuZ3RoIDwgbWluX2xlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1pbiA9IHBhcnNlSW50KHN0YXJ0X2VuZFswXSksXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXggPSBwYXJzZUludChzdGFydF9lbmRbMV0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUubGVuZ3RoIDwgbWluIHx8IHZhbHVlLmxlbmd0aCA+IG1heCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgcnVsZXM6IGZ1bmN0aW9uIChvYmplY3RzKSB7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBvYmplY3RzLnZhbCgpLFxuICAgICAgICAgICAgICAgIHJ1bGUgPSBvYmplY3RzLmF0dHIoXCJkYXRhLXJ1bGVzXCIpO1xuXG4gICAgICAgICAgICBydWxlID0gbmV3IFJlZ0V4cChldmFsKHJ1bGUpKTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gJycgJiYgIXJ1bGUudGVzdCh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSxcblxuICAgICAgICBlcXVhbDogZnVuY3Rpb24gKG9iamVjdHMpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IG9iamVjdHMudmFsKCksXG4gICAgICAgICAgICAgICAgZXF1YWwgPSAkKG9iamVjdHMuYXR0cihcImRhdGEtZXF1YWxcIikpLnZhbCgpO1xuXG4gICAgICAgICAgICBpZiAodmFsdWUgIT09IGVxdWFsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgbW9iaWxlOiBmdW5jdGlvbiAob2JqZWN0cykge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gb2JqZWN0cy52YWwoKSxcbiAgICAgICAgICAgICAgICBydWxlX3RlbCA9IC9eKDBcXGR7MiwzfVxcZHs3LDh9fDBcXGR7MiwzfS0pXFxkezcsOH0kLyxcbiAgICAgICAgICAgICAgICBydWxlX3Bob25lID0gL14oMTNbMC05XXwxNFs1NzldfDE1WzAtMyw1LTldfDE2WzZdfDE3WzAxMzU2NzhdfDE4WzAtOV18MTlbODldKVxcZHs4fSQvO1xuXG4gICAgICAgICAgICBpZiAodmFsdWUgIT09ICcnICYmICFydWxlX3Bob25lLnRlc3QodmFsdWUpICYmICFydWxlX3RlbC50ZXN0KHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuXG4gICAgICAgIGVtYWlsOiBmdW5jdGlvbiAob2JqZWN0cykge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gb2JqZWN0cy52YWwoKSxcbiAgICAgICAgICAgICAgICBydWxlX2VtYWlsID0gL14oW2EtekEtWjAtOV0rW198XFxffFxcLl0/KSpbYS16QS1aMC05XStAKFthLXpBLVowLTldK1tffFxcX3xcXC5dPykqW2EtekEtWjAtOV0rXFwuW2EtekEtWl17MiwzfSQvO1xuXG4gICAgICAgICAgICBpZiAodmFsdWUgIT09ICcnICYmICFydWxlX2VtYWlsLnRlc3QodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0sXG5cbiAgICAgICAgSWRDYXJkOiBmdW5jdGlvbiAob2JqZWN0cykge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gb2JqZWN0cy52YWwoKSxcbiAgICAgICAgICAgICAgICBydWxlX2NhcmQgPSAvXihbMS05XVxcZHs1fVsxXVxcZHszfSgwWzEtOV18MVswLTJdKSgwWzEtOV18WzEtMl1cXGR8M1swLTFdKVxcZHszfVswLTl4WF18WzEtOV1cXGR7NX1cXGR7Mn0oMFsxLTldfDFbMC0yXSkoMFsxLTldfFsxLTJdXFxkfDNbMC0xXSlcXGR7M30pJC87XG5cbiAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gJycgJiYgIXJ1bGVfY2FyZC50ZXN0KHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuXG4gICAgICAgIHVybDogZnVuY3Rpb24gKG9iamVjdHMpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IG9iamVjdHMudmFsKCk7XG5cbiAgICAgICAgICAgIHZhciByID0gL15odHRwcz86XFwvXFwvW0EtWmEtejAtOV0rXFwuW0EtWmEtejAtOV0rW1xcLz1cXD8lXFwtJl9+YEBbXFxdXFwnOishXSooW148PlxcXCJcXFwiXSkqJC87XG4gICAgICAgICAgICBpZiAodmFsdWUgIT09ICcnICYmICFyLnRlc3QodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgX2Zvcm0ucHJvdG90eXBlLmdldENvb2tpZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNvb2tpZVZhbHVlID0gbnVsbDtcbiAgICAgICAgaWYgKGRvY3VtZW50LmNvb2tpZSAmJiBkb2N1bWVudC5jb29raWUgIT09ICcnKSB7XG4gICAgICAgICAgICB2YXIgY29va2llcyA9IGRvY3VtZW50LmNvb2tpZS5zcGxpdCgnOycpO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvb2tpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgY29va2llID0gY29va2llc1tpXS50cmltKCkuc3BsaXQoJz0nKTtcbiAgICAgICAgICAgICAgICBpZiAoY29va2llWzBdID09PSBcImNzcmZ0b2tlblwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvb2tpZVZhbHVlID0gY29va2llWzFdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb29raWVWYWx1ZTtcbiAgICB9O1xuXG4gICAgX2Zvcm0ucHJvdG90eXBlLnNlbmREYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbWUgPSB0aGlzLFxuICAgICAgICAgICAgZGF0YSA9IG5ldyBGb3JtRGF0YShtZS5mb3JtWzBdKTtcblxuICAgICAgICBpZiAobWUub3B0aW9ucy5kYXRhICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICQuZWFjaChtZS5vcHRpb25zLmRhdGEsIGZ1bmN0aW9uIChrLCB2KSB7XG4gICAgICAgICAgICAgICAgZGF0YS5hcHBlbmQoaywgdilcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuICAgICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgIHhoci5vcGVuKG1lLm1ldGhvZCwgbWUudXJsLCBtZS5hc3luYyk7XG4gICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiWC1DU1JGVG9rZW5cIiwgbWUuZ2V0Q29va2llKCkpO1xuICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIngtcmVxdWVzdGVkLXdpdGhcIiwgXCJYTUxIdHRwUmVxdWVzdFwiKTtcbiAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gNCkge1xuICAgICAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1lLm9wdGlvbnMuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWUub3B0aW9ucy5zdWNjZXNzKCQucGFyc2VKU09OKHhoci5yZXNwb25zZVRleHQpKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1lLm9wdGlvbnMuZmFpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWUub3B0aW9ucy5mYWlsKCQucGFyc2VKU09OKHhoci5yZXNwb25zZVRleHQpKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB4aHIuc2VuZChkYXRhKVxuICAgIH07XG5cbiAgICBfZm9ybS5wcm90b3R5cGUubXNnID0ge1xuICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHRhcmdldCwgZXJyb3JNZXNzYWdlKSB7XG4gICAgICAgICAgICB0YXJnZXQuc2libGluZ3MoJy5tZG4tbXNnJykucmVtb3ZlKCk7XG5cbiAgICAgICAgICAgIHRhcmdldC5wYXJlbnQoKS5hZGRDbGFzcygnbWRuLWVycm9yJyk7XG4gICAgICAgICAgICB0YXJnZXQucGFyZW50KCkuYXBwZW5kKCc8c3BhbiBjbGFzcz1cIm1kbi1tc2cgbXNnLWhpZGRlbiByaWdodFwiPicgKyBlcnJvck1lc3NhZ2UgKyAnPC9zcGFuPicpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgICAgICAgIHRhcmdldC5wYXJlbnQoKS5yZW1vdmVDbGFzcygnbWRuLWVycm9yJyk7XG4gICAgICAgICAgICB0YXJnZXQuc2libGluZ3MoJy5tZG4tbXNnJykucmVtb3ZlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgJC5mbi5mb3JtID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHZhbGlkYXRpb24gPSBuZXcgX2Zvcm0odGhpcywgb3B0aW9ucyk7XG5cbiAgICAgICAgcmV0dXJuIHZhbGlkYXRpb24uaW5pdCgpO1xuICAgIH07XG59KShqUXVlcnksIHdpbmRvdywgZG9jdW1lbnQpOyJdfQ==
